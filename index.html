<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ControleFull Financeiro - Sistema Profissional de Gest√£o</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); }
        
        .container { max-width: 1400px; margin: 0 auto; padding: 20px; }
        
        .header { background: white; border-radius: 20px; padding: 30px; margin-bottom: 30px; box-shadow: 0 10px 40px rgba(0,0,0,0.1); }
        .logo { font-size: 36px; font-weight: 800; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); -webkit-background-clip: text; -webkit-text-fill-color: transparent; margin-bottom: 10px; }
        .tagline { color: #666; font-size: 16px; }
        
        .actions { display: flex; gap: 15px; flex-wrap: wrap; }
        .btn { padding: 12px 24px; border: none; border-radius: 10px; font-weight: 600; cursor: pointer; transition: all 0.3s; font-size: 14px; }
        .btn-primary { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; }
        .btn-primary:hover { transform: translateY(-2px); box-shadow: 0 10px 20px rgba(102, 126, 234, 0.3); }
        .btn-success { background: linear-gradient(135deg, #11998e 0%, #38ef7d 100%); color: white; }
        .btn-danger { background: linear-gradient(135deg, #eb3349 0%, #f45c43 100%); color: white; }
        .btn-info { background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%); color: white; }
        
        .tabs { background: white; border-radius: 15px; overflow: hidden; margin-bottom: 20px; box-shadow: 0 5px 20px rgba(0,0,0,0.1); }
        .tab-buttons { display: flex; background: #f8f9fa; overflow-x: auto; }
        .tab-btn { padding: 18px 25px; border: none; background: transparent; cursor: pointer; font-weight: 600; color: #666; transition: all 0.3s; white-space: nowrap; }
        .tab-btn.active { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; }
        
        .content { background: white; border-radius: 15px; padding: 30px; box-shadow: 0 5px 20px rgba(0,0,0,0.1); }
        .tab-content { display: none; }
        .tab-content.active { display: block; }
        
        .cards { display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px; margin-bottom: 30px; }
        .card { padding: 25px; border-radius: 15px; color: white; box-shadow: 0 5px 20px rgba(0,0,0,0.1); }
        .card-green { background: linear-gradient(135deg, #11998e 0%, #38ef7d 100%); }
        .card-red { background: linear-gradient(135deg, #eb3349 0%, #f45c43 100%); }
        .card-blue { background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%); }
        .card-purple { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); }
        .card-label { font-size: 14px; opacity: 0.9; margin-bottom: 8px; }
        .card-value { font-size: 32px; font-weight: 800; }
        
        .form-container { background: #f8f9fa; padding: 25px; border-radius: 15px; margin-bottom: 25px; display: none; }
        .form-container.active { display: block; }
        .form-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; }
        .form-group { display: flex; flex-direction: column; }
        .form-label { font-size: 13px; font-weight: 600; color: #555; margin-bottom: 5px; }
        .form-input { padding: 12px; border: 2px solid #e1e8ed; border-radius: 8px; font-size: 14px; transition: border 0.3s; }
        .form-input:focus { outline: none; border-color: #667eea; }
        
        table { width: 100%; border-collapse: collapse; }
        thead { background: #f8f9fa; }
        th { padding: 15px; text-align: left; font-size: 12px; font-weight: 700; color: #666; text-transform: uppercase; }
        td { padding: 15px; border-bottom: 1px solid #e1e8ed; }
        tbody tr:hover { background: #f8f9fa; }
        
        .badge { display: inline-block; padding: 5px 12px; border-radius: 20px; font-size: 12px; font-weight: 600; }
        .badge-entrada { background: #d4edda; color: #155724; }
        .badge-saida { background: #f8d7da; color: #721c24; }
        
        .empty-state { text-align: center; padding: 60px 20px; color: #999; }
        
        @media (max-width: 768px) {
            .form-grid { grid-template-columns: 1fr; }
            .cards { grid-template-columns: 1fr; }
        }
        
        .watermark { position: fixed; bottom: 20px; right: 20px; background: white; padding: 15px 25px; border-radius: 10px; box-shadow: 0 5px 20px rgba(0,0,0,0.1); font-size: 12px; color: #666; }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <div style="display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; gap: 20px;">
                <div>
                    <div class="logo">üíº ControleFull Financeiro</div>
                    <div class="tagline">Sistema Profissional de Gest√£o Empresarial</div>
                </div>
                <div class="actions">
                    <button class="btn btn-success" onclick="exportExcel()">üìä Exportar Excel</button>
                    <button class="btn btn-info" onclick="exportPDF()">üìÑ Gerar PDF</button>
                    <button class="btn btn-primary" onclick="backup()">üíæ Backup</button>
                    <button class="btn btn-danger" onclick="limparTudo()">üóëÔ∏è Limpar Dados</button>
                </div>
            </div>
        </div>

        <div class="tabs">
            <div class="tab-buttons">
                <button class="tab-btn active" onclick="mudarAba('dashboard')">üìä Dashboard</button>
                <button class="tab-btn" onclick="mudarAba('financeiro')">üí∞ Financeiro</button>
                <button class="tab-btn" onclick="mudarAba('vendas')">üõí Vendas</button>
                <button class="tab-btn" onclick="mudarAba('estoque')">üì¶ Estoque</button>
                <button class="tab-btn" onclick="mudarAba('relatorios')">üìà Relat√≥rios</button>
            </div>
        </div>

        <div id="dashboard" class="tab-content active">
            <div class="content">
                <h2 style="margin-bottom: 25px; color: #333;">üìä Vis√£o Geral</h2>
                <div class="cards">
                    <div class="card card-green">
                        <div class="card-label">üí∞ Receitas Totais</div>
                        <div class="card-value" id="dash-receitas">R$ 0,00</div>
                    </div>
                    <div class="card card-red">
                        <div class="card-label">üí∏ Despesas Totais</div>
                        <div class="card-value" id="dash-despesas">R$ 0,00</div>
                    </div>
                    <div class="card card-blue">
                        <div class="card-label">üíµ Saldo Atual</div>
                        <div class="card-value" id="dash-saldo">R$ 0,00</div>
                    </div>
                    <div class="card card-purple">
                        <div class="card-label">üõçÔ∏è Total Vendas</div>
                        <div class="card-value" id="dash-vendas">R$ 0,00</div>
                    </div>
                </div>
                
                <div style="background: #f8f9fa; padding: 30px; border-radius: 15px; text-align: center;">
                    <h3 style="color: #667eea; margin-bottom: 15px;">üéØ Resumo do Per√≠odo</h3>
                    <p style="color: #666; line-height: 1.8;">
                        Gerencie suas finan√ßas, vendas e estoque de forma profissional.<br>
                        Todos os dados s√£o salvos automaticamente e podem ser exportados para Excel.
                    </p>
                </div>
            </div>
        </div>

        <div id="financeiro" class="tab-content">
            <div class="content">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 25px; flex-wrap: wrap; gap: 15px;">
                    <h2 style="color: #333;">üí∞ Controle Financeiro</h2>
                    <button class="btn btn-primary" onclick="mostrarForm('formFin')">‚ûï Nova Transa√ß√£o</button>
                </div>

                <div id="formFin" class="form-container">
                    <h3 style="margin-bottom: 20px; color: #333;">Nova Transa√ß√£o Financeira</h3>
                    <div class="form-grid">
                        <div class="form-group">
                            <label class="form-label">Data</label>
                            <input type="date" id="fin-data" class="form-input">
                        </div>
                        <div class="form-group">
                            <label class="form-label">Tipo</label>
                            <select id="fin-tipo" class="form-input">
                                <option value="entrada">üí∞ Entrada</option>
                                <option value="saida">üí∏ Sa√≠da</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Descri√ß√£o</label>
                            <input type="text" id="fin-desc" placeholder="Ex: Pagamento Cliente" class="form-input">
                        </div>
                        <div class="form-group">
                            <label class="form-label">Categoria</label>
                            <select id="fin-cat" class="form-input">
                                <option value="">Selecione...</option>
                                <option value="Vendas">Vendas</option>
                                <option value="Servi√ßos">Servi√ßos</option>
                                <option value="Fornecedores">Fornecedores</option>
                                <option value="Sal√°rios">Sal√°rios</option>
                                <option value="Aluguel">Aluguel</option>
                                <option value="Contas">Contas</option>
                                <option value="Marketing">Marketing</option>
                                <option value="Outros">Outros</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Valor (R$)</label>
                            <input type="number" step="0.01" id="fin-valor" placeholder="0,00" class="form-input">
                        </div>
                        <div class="form-group" style="display: flex; gap: 10px; align-items: flex-end;">
                            <button class="btn btn-success" onclick="salvarFin()" style="flex: 1;">üíæ Salvar</button>
                            <button class="btn btn-danger" onclick="fecharForm('formFin')">‚ùå Cancelar</button>
                        </div>
                    </div>
                </div>

                <table>
                    <thead>
                        <tr>
                            <th>Data</th>
                            <th>Descri√ß√£o</th>
                            <th>Categoria</th>
                            <th>Tipo</th>
                            <th>Valor</th>
                            <th>A√ß√µes</th>
                        </tr>
                    </thead>
                    <tbody id="tabelaFin"></tbody>
                </table>
            </div>
        </div>

        <div id="vendas" class="tab-content">
            <div class="content">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 25px; flex-wrap: wrap; gap: 15px;">
                    <h2 style="color: #333;">üõí Controle de Vendas</h2>
                    <button class="btn btn-primary" onclick="mostrarForm('formVenda')">‚ûï Nova Venda</button>
                </div>

                <div id="formVenda" class="form-container">
                    <h3 style="margin-bottom: 20px; color: #333;">Registrar Nova Venda</h3>
                    <div class="form-grid">
                        <div class="form-group">
                            <label class="form-label">Data</label>
                            <input type="date" id="v-data" class="form-input">
                        </div>
                        <div class="form-group">
                            <label class="form-label">Cliente</label>
                            <input type="text" id="v-cliente" placeholder="Nome do cliente" class="form-input">
                        </div>
                        <div class="form-group">
                            <label class="form-label">Produto/Servi√ßo</label>
                            <input type="text" id="v-produto" placeholder="Produto vendido" class="form-input">
                        </div>
                        <div class="form-group">
                            <label class="form-label">Quantidade</label>
                            <input type="number" id="v-qtd" placeholder="1" class="form-input">
                        </div>
                        <div class="form-group">
                            <label class="form-label">Valor Unit√°rio (R$)</label>
                            <input type="number" step="0.01" id="v-valor" placeholder="0,00" class="form-input">
                        </div>
                        <div class="form-group" style="display: flex; gap: 10px; align-items: flex-end;">
                            <button class="btn btn-success" onclick="salvarVenda()" style="flex: 1;">üíæ Salvar</button>
                            <button class="btn btn-danger" onclick="fecharForm('formVenda')">‚ùå Cancelar</button>
                        </div>
                    </div>
                </div>

                <table>
                    <thead>
                        <tr>
                            <th>Data</th>
                            <th>Cliente</th>
                            <th>Produto</th>
                            <th>Quantidade</th>
                            <th>Valor Unit.</th>
                            <th>Total</th>
                            <th>A√ß√µes</th>
                        </tr>
                    </thead>
                    <tbody id="tabelaVenda"></tbody>
                </table>
            </div>
        </div>

        <div id="estoque" class="tab-content">
            <div class="content">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 25px; flex-wrap: wrap; gap: 15px;">
                    <h2 style="color: #333;">üì¶ Controle de Estoque</h2>
                    <button class="btn btn-primary" onclick="mostrarForm('formEst')">‚ûï Movimentar Estoque</button>
                </div>

                <div id="formEst" class="form-container">
                    <h3 style="margin-bottom: 20px; color: #333;">Movimenta√ß√£o de Estoque</h3>
                    <div class="form-grid">
                        <div class="form-group">
                            <label class="form-label">Data</label>
                            <input type="date" id="e-data" class="form-input">
                        </div>
                        <div class="form-group">
                            <label class="form-label">Produto</label>
                            <input type="text" id="e-produto" placeholder="Nome do produto" class="form-input">
                        </div>
                        <div class="form-group">
                            <label class="form-label">Tipo</label>
                            <select id="e-tipo" class="form-input">
                                <option value="entrada">üì• Entrada</option>
                                <option value="saida">üì§ Sa√≠da</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Quantidade</label>
                            <input type="number" id="e-qtd" placeholder="1" class="form-input">
                        </div>
                        <div class="form-group">
                            <label class="form-label">Observa√ß√£o</label>
                            <input type="text" id="e-obs" placeholder="Opcional" class="form-input">
                        </div>
                        <div class="form-group" style="display: flex; gap: 10px; align-items: flex-end;">
                            <button class="btn btn-success" onclick="salvarEst()" style="flex: 1;">üíæ Salvar</button>
                            <button class="btn btn-danger" onclick="fecharForm('formEst')">‚ùå Cancelar</button>
                        </div>
                    </div>
                </div>

                <table>
                    <thead>
                        <tr>
                            <th>Data</th>
                            <th>Produto</th>
                            <th>Tipo</th>
                            <th>Quantidade</th>
                            <th>Saldo</th>
                            <th>Observa√ß√£o</th>
                            <th>A√ß√µes</th>
                        </tr>
                    </thead>
                    <tbody id="tabelaEst"></tbody>
                </table>
            </div>
        </div>

        <div id="relatorios" class="tab-content">
            <div class="content">
                <h2 style="margin-bottom: 25px; color: #333;">üìà Relat√≥rios e An√°lises</h2>
                
                <div class="form-grid" style="margin-bottom: 30px;">
                    <div class="form-group">
                        <label class="form-label">Per√≠odo</label>
                        <input type="month" id="rel-periodo" class="form-input">
                    </div>
                    <div class="form-group">
                        <label class="form-label">Tipo de Relat√≥rio</label>
                        <select id="rel-tipo" class="form-input">
                            <option value="mensal">Relat√≥rio Mensal</option>
                            <option value="categoria">Por Categoria</option>
                            <option value="completo">Completo</option>
                        </select>
                    </div>
                    <div class="form-group" style="display: flex; align-items: flex-end;">
                        <button class="btn btn-primary" onclick="gerarRelatorio()" style="width: 100%;">üîç Gerar Relat√≥rio</button>
                    </div>
                </div>

                <div id="relatorioConteudo" style="background: #f8f9fa; padding: 40px; border-radius: 15px; text-align: center; color: #999;">
                    Selecione um per√≠odo e tipo de relat√≥rio para visualizar as an√°lises
                </div>
            </div>
        </div>
    </div>

    <div class="watermark">
        <strong>ControleFull Financeiro</strong> v1.0<br>
        ¬© 2025 - Sistema Profissional
    </div>

    <script>
        let dados = { financeiro: [], vendas: [], estoque: [] };
        const CHAVE = 'controlefull_dados';

        function init() {
            carregar();
            definirDatas();
            renderizar();
            atualizarDash();
        }

        function carregar() {
            const salvo = localStorage.getItem(CHAVE);
            if (salvo) dados = JSON.parse(salvo);
        }

        function salvar() {
            localStorage.setItem(CHAVE, JSON.stringify(dados));
        }

        function definirDatas() {
            const hoje = new Date().toISOString().split('T')[0];
            document.getElementById('fin-data').value = hoje;
            document.getElementById('v-data').value = hoje;
            document.getElementById('e-data').value = hoje;
            document.getElementById('rel-periodo').value = hoje.substring(0, 7);
        }

        function mudarAba(aba) {
            document.querySelectorAll('.tab-content').forEach(el => el.classList.remove('active'));
            document.querySelectorAll('.tab-btn').forEach(el => el.classList.remove('active'));
            document.getElementById(aba).classList.add('active');
            event.target.classList.add('active');
            if (aba === 'dashboard') atualizarDash();
        }

        function mostrarForm(id) {
            document.getElementById(id).classList.add('active');
        }

        function fecharForm(id) {
            document.getElementById(id).classList.remove('active');
        }

        // FINANCEIRO
        function salvarFin() {
            const item = {
                id: Date.now(),
                data: document.getElementById('fin-data').value,
                tipo: document.getElementById('fin-tipo').value,
                descricao: document.getElementById('fin-desc').value,
                categoria: document.getElementById('fin-cat').value,
                valor: parseFloat(document.getElementById('fin-valor').value)
            };
            if (!item.descricao || !item.categoria || !item.valor) { alert('‚ùå Preencha todos os campos!'); return; }
            dados.financeiro.push(item);
            salvar();
            renderizarFin();
            atualizarDash();
            fecharForm('formFin');
            alert('‚úÖ Transa√ß√£o salva com sucesso!');
        }

        function excluirFin(id) {
            if (confirm('Deseja realmente excluir?')) {
                dados.financeiro = dados.financeiro.filter(i => i.id !== id);
                salvar();
                renderizarFin();
                atualizarDash();
            }
        }

        function renderizarFin() {
            const tbody = document.getElementById('tabelaFin');
            if (dados.financeiro.length === 0) {
                tbody.innerHTML = '<tr><td colspan="6" class="empty-state">Nenhuma transa√ß√£o registrada</td></tr>';
                return;
            }
            tbody.innerHTML = dados.financeiro.sort((a, b) => new Date(b.data) - new Date(a.data)).map(i => `
                <tr>
                    <td>${formatarData(i.data)}</td>
                    <td><strong>${i.descricao}</strong></td>
                    <td><span style="background: #f0f0f0; padding: 5px 10px; border-radius: 5px; font-size: 12px;">${i.categoria}</span></td>
                    <td><span class="badge badge-${i.tipo}">${i.tipo === 'entrada' ? 'üí∞ Entrada' : 'üí∏ Sa√≠da'}</span></td>
                    <td style="font-weight: 700; color: ${i.tipo === 'entrada' ? '#11998e' : '#eb3349'};">${formatarMoeda(i.valor)}</td>
                    <td><button onclick="excluirFin(${i.id})" style="background: none; border: none; cursor: pointer; font-size: 18px;">üóëÔ∏è</button></td>
                </tr>
            `).join('');
        }

        // VENDAS
        function salvarVenda() {
            const qtd = parseFloat(document.getElementById('v-qtd').value);
            const valor = parseFloat(document.getElementById('v-valor').value);
            const item = {
                id: Date.now(),
                data: document.getElementById('v-data').value,
                cliente: document.getElementById('v-cliente').value,
                produto: document.getElementById('v-produto').value,
                quantidade: qtd,
                valorUnit: valor,
                total: qtd * valor
            };
            if (!item.cliente || !item.produto || !qtd || !valor) { alert('‚ùå Preencha todos os campos!'); return; }
            dados.vendas.push(item);
            salvar();
            renderizarVenda();
            atualizarDash();
            fecharForm('formVenda');
            alert('‚úÖ Venda registrada com sucesso!');
        }

        function excluirVenda(id) {
            if (confirm('Deseja realmente excluir?')) {
                dados.vendas = dados.vendas.filter(i => i.id !== id);
                salvar();
                renderizarVenda();
                atualizarDash();
            }
        }

        function renderizarVenda() {
            const tbody = document.getElementById('tabelaVenda');
            if (dados.vendas.length === 0) {
                tbody.innerHTML = '<tr><td colspan="7" class="empty-state">Nenhuma venda registrada</td></tr>';
                return;
            }
            tbody.innerHTML = dados.vendas.sort((a, b) => new Date(b.data) - new Date(a.data)).map(i => `
                <tr>
                    <td>${formatarData(i.data)}</td>
                    <td><strong>${i.cliente}</strong></td>
                    <td>${i.produto}</td>
                    <td>${i.quantidade}</td>
                    <td>${formatarMoeda(i.valorUnit)}</td>
                    <td style="font-weight: 700; color: #667eea;">${formatarMoeda(i.total)}</td>
                    <td><button onclick="excluirVenda(${i.id})" style="background: none; border: none; cursor: pointer; font-size: 18px;">üóëÔ∏è</button></td>
                </tr>
            `).join('');
        }

        // ESTOQUE
        function salvarEst() {
            const item = {
                id: Date.now(),
                data: document.getElementById('e-data').value,
                produto: document.getElementById('e-produto').value,
                tipo: document.getElementById('e-tipo').value,
                quantidade: parseInt(document.getElementById('e-qtd').value),
                observacao: document.getElementById('e-obs').value
            };
            if (!item.produto || !item.quantidade) { alert('‚ùå Preencha os campos obrigat√≥rios!'); return; }
            dados.estoque.push(item);
            salvar();
            renderizarEst();
            fecharForm('formEst');
            alert('‚úÖ Movimenta√ß√£o registrada!');
        }

        function excluirEst(id) {
            if (confirm('Deseja realmente excluir?')) {
                dados.estoque = dados.estoque.filter(i => i.id !== id);
                salvar();
                renderizarEst();
            }
        }

        function renderizarEst() {
            const tbody = document.getElementById('tabelaEst');
            if (dados.estoque.length === 0) {
                tbody.innerHTML = '<tr><td colspan="7" class="empty-state">Nenhuma movimenta√ß√£o registrada</td></tr>';
                return;
            }

            const saldos = {};
            const ordenado = [...dados.estoque].sort((a, b) => new Date(a.data) - new Date(b.data));
            ordenado.forEach(i => {
                if (!saldos[i.produto]) saldos[i.produto] = 0;
                saldos[i.produto] += i.tipo === 'entrada' ? i.quantidade : -i.quantidade;
                i.saldo = saldos[i.produto];
            });

            tbody.innerHTML = ordenado.reverse().map(i => `
                <tr>
                    <td>${formatarData(i.data)}</td>
                    <td><strong>${i.produto}</strong></td>
                    <td><span class="badge badge-${i.tipo}">${i.tipo === 'entrada' ? 'üì• Entrada' : 'üì§ Sa√≠da'}</span></td>
                    <td>${i.quantidade}</td>
                    <td style="font-weight: 700; color: #667eea;">${i.saldo}</td>
                    <td>${i.observacao || '-'}</td>
                    <td><button onclick="excluirEst(${i.id})" style="background: none; border: none; cursor: pointer; font-size: 18px;">üóëÔ∏è</button></td>
                </tr>
            `).join('');
        }

        function atualizarDash() {
            const receitas = dados.financeiro.filter(
